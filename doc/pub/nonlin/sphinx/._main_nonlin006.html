

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Exercises</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>

        <script src="http://sagecell.sagemath.org/static/jquery.min.js"></script>
        <script src="http://sagecell.sagemath.org/static/embedded_sagecell.js"></script>

        <script>sagecell.makeSagecell({inputLocation: ".sage"});</script>

        <style type="text/css">
                .sagecell .CodeMirror-scroll {
                        overflow-y: hidden;
                        overflow-x: auto;
                }
                .sagecell .CodeMirror {
                        height: auto;
                }
        </style>

    
    <link rel="top" title="Nonlinear differential equation problems" href="index.html" />
    <link rel="prev" title="Multi-dimensional PDE problems" href="._main_nonlin005.html" />
 
  
   <style type="text/css">
     div.admonition {
       background-color: whiteSmoke;
       border: 1px solid #bababa;
     }
   </style>
  </head>

  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="._main_nonlin005.html" title="Multi-dimensional PDE problems"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Nonlinear differential equation problems</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="exercises">
<span id="nonlin-exer"></span><h1>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h1>
<div class="section" id="problem-1-determine-if-equations-are-nonlinear-or-not">
<span id="nonlin-exer-lin-vs-nonlin"></span><h2>Problem 1: Determine if equations are nonlinear or not<a class="headerlink" href="#problem-1-determine-if-equations-are-nonlinear-or-not" title="Permalink to this headline">¶</a></h2>
<p>Classify each term in the following equations as linear or nonlinear.
Assume that <span class="math">\(a\)</span> and <span class="math">\(b\)</span> are unknown
numbers and that <span class="math">\(u\)</span> and <span class="math">\(v\)</span> are unknown functions.
All other symbols are known quantities.</p>
<ol class="arabic simple">
<li><span class="math">\(b^2 = 1\)</span></li>
<li><span class="math">\(a+b = 1\)</span>, <span class="math">\(a-2b = 0\)</span></li>
<li><span class="math">\(mu^{\prime\prime} + \beta |u^{\prime}|u^{\prime} + cu = F(t)\)</span></li>
<li><span class="math">\(u_t = {\alpha} u_{xx}\)</span></li>
<li><span class="math">\(u_{tt} = c^2\nabla^2 u\)</span></li>
<li><span class="math">\(u_t = \nabla\cdot({\alpha}(u)\nabla u) + f(x,y)\)</span></li>
<li><span class="math">\(u_t + f(u)_x = 0\)</span></li>
<li><span class="math">\(\boldsymbol{u}_t + \boldsymbol{u}\cdot\nabla \boldsymbol{u} = -\nabla p + r\nabla^2\boldsymbol{u}\)</span>, <span class="math">\(\nabla\cdot\boldsymbol{u} = 0\)</span>
(<span class="math">\(\boldsymbol{u}\)</span> is a vector field)</li>
<li><span class="math">\(u^{\prime} = f(u,t)\)</span></li>
<li><span class="math">\(\nabla^2 u = \lambda e^u\)</span></li>
</ol>
</div>
<div class="section" id="exercise-2-derive-a-formula">
<span id="nonlin-exer-relax-formula"></span><h2>Exercise 2: Derive a formula<a class="headerlink" href="#exercise-2-derive-a-formula" title="Permalink to this headline">¶</a></h2>
<p>Derive <a class="reference internal" href="._main_nonlin001.html#eq-nonlin-timediscrete-logistic-relaxation-newton-formula"><em>(2.9)</em></a>
in the section <a class="reference internal" href="._main_nonlin001.html#nonlin-timediscrete-logistic-relaxation"><em>Relaxation</em></a>.
Filename: <tt class="docutils literal"><span class="pre">relaxed_Newton.pdf</span></tt>.</p>
</div>
<div class="section" id="problem-3-experience-the-behavior-of-newton-s-method">
<span id="nonlin-exer-newton-problems1"></span><h2>Problem 3: Experience the behavior of Newton&#8217;s method<a class="headerlink" href="#problem-3-experience-the-behavior-of-newton-s-method" title="Permalink to this headline">¶</a></h2>
<p>The program <a class="reference external" href="http://tinyurl.com/nm5587k/nonlin/Newton_demo.py">Newton_demo.py</a> illustrates
graphically each step in Newton&#8217;s method and is run like</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; python Newton_demo.py f dfdx x0 xmin xmax
</pre></div>
</div>
<p>Use this program to investigate potential
problems with Newton&#8217;s method when solving <span class="math">\(e^{-0.5x^2}\cos (\pi x)=0\)</span>.
Try a starting point <span class="math">\(x_0=0.8\)</span> and <span class="math">\(x_0=0.85\)</span> and watch the different
behavior. Just run</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt;  python Newton_demo.py &#39;0.2 + exp(-0.5*x**2)*cos(pi*x)&#39; \
           &#39;-x*exp(-x**2)*cos(pi*x) - pi*exp(-x**2)*sin(pi*x)&#39; \
           0.85 -3 3
</pre></div>
</div>
<p>and repeat with 0.85 replaced by 0.8.</p>
</div>
<div class="section" id="problem-4-linearize-a-nonlinear-vibration-ode">
<span id="nonlin-exer-vib-geometric-mean"></span><h2>Problem 4: Linearize a nonlinear vibration ODE<a class="headerlink" href="#problem-4-linearize-a-nonlinear-vibration-ode" title="Permalink to this headline">¶</a></h2>
<p>Consider a nonlinear vibration problem</p>
<div class="math">
\[mu^{\prime\prime} + bu^{\prime}|u^{\prime}| + s(u) = F(t),\]</div>
<p>where <span class="math">\(m&gt;0\)</span> is a constant, <span class="math">\(b\geq 0\)</span> is a constant, <span class="math">\(s(u)\)</span> a possibly
nonlinear function of <span class="math">\(u\)</span>, and <span class="math">\(F(t)\)</span> is a prescribed function. Such
models arise from Newton&#8217;s second law of motion in mechanical
vibration problems where <span class="math">\(s(u)\)</span> is a spring or restoring force,
<span class="math">\(mu^{\prime\prime}\)</span> is mass times acceleration, and
<span class="math">\(bu^{\prime}|u^{\prime}|\)</span> models water or air drag.</p>
<p>Rewrite the equation for <span class="math">\(u\)</span> as a system of two first-order ODEs, and
discretize this system by a Crank-Nicolson (centered difference)
method. With <span class="math">\(v=u^\prime\)</span>, we get a nonlinear term
<span class="math">\(v^{n+\frac{1}{2}}|v^{n+\frac{1}{2}}|\)</span>. Use both a geometric and an
arithmetic average for <span class="math">\(v^{n+\frac{1}{2}}\)</span>. In the latter case,
explain how to apply Newton&#8217;s method to solve the nonlinear equations
at each time level.</p>
</div>
<div class="section" id="exercise-5-find-the-sparsity-of-the-jacobian">
<span id="nonlin-exer-sparsity-jacobian"></span><h2>Exercise 5: Find the sparsity of the Jacobian<a class="headerlink" href="#exercise-5-find-the-sparsity-of-the-jacobian" title="Permalink to this headline">¶</a></h2>
<p>Consider a typical nonlinear Laplace term like
<span class="math">\(\nabla\cdot{\alpha}(u)\nabla u\)</span> discretized by centered finite differences.
Explain why the Jacobian corresponding to this term has the same
sparsity pattern as the matrix associated with the corresponding linear
term <span class="math">\({\alpha}\nabla^2 u\)</span>.</p>
<p><strong>Hint.</strong>
Set up the unknowns that enter the difference stencil and find the
sparsity of the Jacobian that arise from the stencil.</p>
<p>Filename: <tt class="docutils literal"><span class="pre">nonlin_sparsity_Jacobian.pdf</span></tt>.</p>
</div>
<div class="section" id="exercise-6-newton-s-method-for-linear-problems">
<span id="nonlin-exer-newton-linear"></span><h2>Exercise 6: Newton&#8217;s method for linear problems<a class="headerlink" href="#exercise-6-newton-s-method-for-linear-problems" title="Permalink to this headline">¶</a></h2>
<p>Suppose we have a linear system <span class="math">\(F(u) = Au- b=0\)</span>. Apply Newton&#8217;s method
to this system, and show that the method converges in one iteration.
Filename: <tt class="docutils literal"><span class="pre">nonlin_Newton_linear.pdf</span></tt>.</p>
</div>
<div class="section" id="exercise-7-differentiate-a-highly-nonlinear-term">
<span id="nonlin-exer-grad-pow-term"></span><h2>Exercise 7: Differentiate a highly nonlinear term<a class="headerlink" href="#exercise-7-differentiate-a-highly-nonlinear-term" title="Permalink to this headline">¶</a></h2>
<p>The operator <span class="math">\(\nabla\cdot({\alpha}(u)\nabla u)\)</span> with
<span class="math">\({\alpha}(u) = ||\nabla u||^q\)</span> appears in several physical problems,
especially flow of Non-Newtonian fluids. In a Newton method one
has to carry out the differentiation <span class="math">\(\partial{\alpha}(u)/\partial c_j\)</span>,
for <span class="math">\(u=\sum_kc_k{\psi}_k\)</span>. Show that</p>
<div class="math">
\[{\partial\over\partial u_j} ||\nabla u||^q =
q||\nabla  u||^{q-2}\nabla u\cdot
\nabla{\psi}_j{\thinspace .}\]</div>
<p>Filename: <tt class="docutils literal"><span class="pre">nonlin_differentiate.pdf</span></tt>.</p>
</div>
<div class="section" id="problem-8-discretize-a-1d-problem-with-a-nonlinear-coefficient">
<span id="nonlin-exer-1d-1pu2-fem"></span><h2>Problem 8: Discretize a 1D problem with a nonlinear coefficient<a class="headerlink" href="#problem-8-discretize-a-1d-problem-with-a-nonlinear-coefficient" title="Permalink to this headline">¶</a></h2>
<p>We consider the problem</p>
<div class="math" id="equation-nonlin:exer:1D:1pu2:fem:pde">
<span id="eq-nonlin-exer-1d-1pu2-fem-pde"></span><span class="eqno">(1)</span>\[     ((1 + u^2)u^{\prime})^{\prime} = 1,\quad x\in (0,1),\quad u(0)=u(1)=0{\thinspace .}\]</div>
<p><strong>a)</strong>
Discretize <a href="#equation-nonlin:exer:1D:1pu2:fem:pde">(1)</a> by a centered
finite difference method on a uniform mesh.</p>
<p><strong>b)</strong>
Discretize <a href="#equation-nonlin:exer:1D:1pu2:fem:pde">(1)</a> by a finite
element method with P1 of equal length.
Use the Trapezoidal method to compute all integrals.
Set up the resulting matrix system.</p>
<p>Filename: <tt class="docutils literal"><span class="pre">nonlin_1D_coeff_discretize.pdf</span></tt>.</p>
</div>
<div class="section" id="problem-9-linearize-a-1d-problem-with-a-nonlinear-coefficient">
<span id="nonlin-exer-1d-1pu2-picardnewton"></span><h2>Problem 9: Linearize a 1D problem with a nonlinear coefficient<a class="headerlink" href="#problem-9-linearize-a-1d-problem-with-a-nonlinear-coefficient" title="Permalink to this headline">¶</a></h2>
<p>We have a two-point boundary value problem</p>
<div class="math" id="equation-nonlin:exer:1D:1pu2:PicardNewton:pde">
<span id="eq-nonlin-exer-1d-1pu2-picardnewton-pde"></span><span class="eqno">(2)</span>\[     ((1 + u^2)u^{\prime})^{\prime} = 1,\quad x\in (0,1),\quad u(0)=u(1)=0{\thinspace .}\]</div>
<p><strong>a)</strong>
Construct a Picard iteration method for <a href="#equation-nonlin:exer:1D:1pu2:PicardNewton:pde">(2)</a>
without discretizing in space.</p>
<p><strong>b)</strong>
Apply Newton&#8217;s method to <a href="#equation-nonlin:exer:1D:1pu2:PicardNewton:pde">(2)</a>
without discretizing in space.</p>
<p><strong>c)</strong>
Discretize <a href="#equation-nonlin:exer:1D:1pu2:PicardNewton:pde">(2)</a> by a centered finite
difference scheme. Construct a Picard method for the resulting
system of nonlinear algebraic equations.</p>
<p><strong>d)</strong>
Discretize <a href="#equation-nonlin:exer:1D:1pu2:PicardNewton:pde">(2)</a> by a centered finite
difference scheme. Define the system of nonlinear algebraic equations,
calculate the Jacobian, and set up Newton&#8217;s method for solving the system.</p>
<p>Filename: <tt class="docutils literal"><span class="pre">nonlin_1D_coeff_linearize.pdf</span></tt>.</p>
</div>
<div class="section" id="problem-10-finite-differences-for-the-1d-bratu-problem">
<span id="nonlin-exer-1d-fu-discretize-fd"></span><h2>Problem 10: Finite differences for the 1D Bratu problem<a class="headerlink" href="#problem-10-finite-differences-for-the-1d-bratu-problem" title="Permalink to this headline">¶</a></h2>
<p>We address the so-called Bratu problem</p>
<div class="math" id="equation-nonlin:exer:1D:fu:discretize:fd:pde">
<span id="eq-nonlin-exer-1d-fu-discretize-fd-pde"></span><span class="eqno">(3)</span>\[     u^{\prime\prime} + \lambda e^u=0,\quad x\in (0,1),\quad u(0)=u(1)=0,\]</div>
<p>where <span class="math">\(\lambda\)</span> is a given parameter and <span class="math">\(u\)</span> is a function of <span class="math">\(x\)</span>.
This is a widely used model problem for studying numerical
methods for nonlinear differential equations.
The problem <a href="#equation-nonlin:exer:1D:fu:discretize:fd:pde">(3)</a> has an
exact solution</p>
<div class="math">
\[u(x) = -2\ln\left(\frac{\cosh((x-\frac{1}{2})\theta/2)}{\cosh(\theta/4)}\right),\]</div>
<p>where <span class="math">\(\theta\)</span> solves</p>
<div class="math">
\[\theta = \sqrt{2\lambda}\cosh(\theta/4){\thinspace .}\]</div>
<p>There are two solutions of <a href="#equation-nonlin:exer:1D:fu:discretize:fd:pde">(3)</a> for
<span class="math">\(0&lt;\lambda &lt;\lambda_c\)</span> and no solution for <span class="math">\(\lambda &gt;\lambda_c\)</span>.
For <span class="math">\(\lambda = \lambda_c\)</span> there is one unique solution. The critical
value <span class="math">\(\lambda_c\)</span> solves</p>
<div class="math">
\[1 = \sqrt{2\lambda_c}\frac{1}{4}\sinh(\theta(\lambda_c)/4){\thinspace .}\]</div>
<p>A numerical value is <span class="math">\(\lambda_c = 3.513830719\)</span>.</p>
<p><strong>a)</strong>
Discretize <a href="#equation-nonlin:exer:1D:fu:discretize:fd:pde">(3)</a> by a
centered finite difference method.</p>
<p><strong>b)</strong>
Set up the nonlinear equations <span class="math">\(F_i(u_0,u_1,\ldots,u_{N_x})=0\)</span>
from a). Calculate the associated Jacobian.</p>
<p>Filename: <tt class="docutils literal"><span class="pre">nonlin_1D_Bratu_fd.pdf</span></tt>.</p>
</div>
<div class="section" id="problem-11-integrate-functions-of-finite-element-expansions">
<span id="nonlin-exer-fu-fem-int"></span><h2>Problem 11: Integrate functions of finite element expansions<a class="headerlink" href="#problem-11-integrate-functions-of-finite-element-expansions" title="Permalink to this headline">¶</a></h2>
<span class="target" id="index-0"></span><p id="index-1">We shall investigate integrals on the form</p>
<div class="math" id="equation-nonlin:exer:fu:fem:int:global">
<span id="eq-nonlin-exer-fu-fem-int-global"></span><span class="eqno">(4)</span>\[     \int_0^L f(\sum_ku_k{\varphi}_k(x)){\varphi}_i(x){\, \mathrm{d}x},\]</div>
<p>where <span class="math">\({\varphi}_i(x)\)</span> are P1 finite element basis functions and <span class="math">\(u_k\)</span>
are unknown coefficients, more precisely the values of the unknown
function <span class="math">\(u\)</span> at nodes <span class="math">\(x_{k}\)</span>. We introduce a node numbering that
goes from left to right and also that all cells have
the same length <span class="math">\(h\)</span>. Given <span class="math">\(i\)</span>, the integral
only gets contributions from <span class="math">\([x_{i-1},x_{i+1}]\)</span>. On this
interval <span class="math">\({\varphi}_k(x)=0\)</span> for <span class="math">\(k&lt;i-1\)</span> and <span class="math">\(k&gt;i+1\)</span>, so only three
basis functions will contribute:</p>
<div class="math">
\[\sum_k u_k{\varphi}_k(x) = u_{i-1}{\varphi}_{i-1}(x) +
u_{i}{\varphi}_{i}(x) + u_{i+1}{\varphi}_{i+1}(x){\thinspace .}\]</div>
<p>The integral <a href="#equation-nonlin:exer:fu:fem:int:global">(4)</a> now takes the
simplified form</p>
<div class="math">
\[\int_{x_{i-1}}^{x_{i+1}}
f(u_{i-1}{\varphi}_{i-1}(x) +
u_{i}{\varphi}_{i}(x) + u_{i+1}{\varphi}_{i+1}(x)){\varphi}_i(x){\, \mathrm{d}x}{\thinspace .}\]</div>
<p>Split this integral in two integrals over cell L (left),
<span class="math">\([x_{i-1},x_{i}]\)</span>, and cell R (right), <span class="math">\([x_{i},x_{i+1}]\)</span>. Over
cell L, <span class="math">\(u\)</span> simplifies to <span class="math">\(u_{i-1}{\varphi}_{i-1} + u_{i}{\varphi}_{i}\)</span>
(since <span class="math">\({\varphi}_{i+1}=0\)</span> on this cell), and over cell R, <span class="math">\(u\)</span>
simplifies to <span class="math">\(u_{i}{\varphi}_{i} + u_{i+1}{\varphi}_{i+1}\)</span>.  Make a
<tt class="docutils literal"><span class="pre">sympy</span></tt> program that can compute the integral and write it out as a
difference equation. Give the <span class="math">\(f(u)\)</span> formula on the command line.
Try out <span class="math">\(f(u)=u^2, \sin u, \exp u\)</span>.</p>
<p><strong>Hint.</strong>
Introduce symbols <tt class="docutils literal"><span class="pre">u_i</span></tt>, <tt class="docutils literal"><span class="pre">u_im1</span></tt>, and <tt class="docutils literal"><span class="pre">u_ip1</span></tt> for <span class="math">\(u_i\)</span>, <span class="math">\(u_{i-1}\)</span>,
and <span class="math">\(u_{i+1}\)</span>, respectively, and similar symbols for <span class="math">\(x_i\)</span>, <span class="math">\(x_{i-1}\)</span>,
and <span class="math">\(x_{i+1}\)</span>. Find formulas for the basis functions on each of the
two cells, make expressions for <span class="math">\(u\)</span> on the two cells, integrate over
each cell, expand the answer and simplify. You can make
LaTeX code and render it via
<a class="reference external" href="http://latex.codecogs.com">http://latex.codecogs.com</a>. Here are some appropriate Python statements
for the latter purpose:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="o">...</span>
<span class="c"># expr_i holdes the integral as a sympy expression</span>
<span class="n">latex_code</span> <span class="o">=</span> <span class="n">latex</span><span class="p">(</span><span class="n">expr_i</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;plain&#39;</span><span class="p">)</span>
<span class="c"># Replace u_im1 sympy symbol name by latex symbol u_{i-1}</span>
<span class="n">latex_code</span> <span class="o">=</span> <span class="n">latex_code</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;im1&#39;</span><span class="p">,</span> <span class="s">&#39;{i-1}&#39;</span><span class="p">)</span>
<span class="c"># Replace u_ip1 sympy symbol name by latex symbol u_{i+1}</span>
<span class="n">latex_code</span> <span class="o">=</span> <span class="n">latex_code</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;ip1&#39;</span><span class="p">,</span> <span class="s">&#39;{i+1}&#39;</span><span class="p">)</span>
<span class="c"># Escape (quote) latex_code so it can be sent as HTML text</span>
<span class="kn">import</span> <span class="nn">cgi</span>
<span class="n">html_code</span> <span class="o">=</span> <span class="n">cgi</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">latex_code</span><span class="p">)</span>
<span class="c"># Make a file with HTML code for displaying the LaTeX formula</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;tmp.html&#39;</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>
<span class="c"># Include an image that can be clicked on to yield a new</span>
<span class="c"># page with an interactive editor and display area where the</span>
<span class="c"># formula can be further edited</span>
<span class="n">text</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">&lt;a href=&quot;http://www.codecogs.com/eqnedit.php?latex=</span><span class="si">%(html_code)s</span><span class="s">&quot;</span>
<span class="s"> target=&quot;_blank&quot;&gt;</span>
<span class="s">&lt;img src=&quot;http://latex.codecogs.com/gif.latex?</span><span class="si">%(html_code)s</span><span class="s">&quot;</span>
<span class="s"> title=&quot;</span><span class="si">%(latex_code)s</span><span class="s">&quot;/&gt;</span>
<span class="s">&lt;/a&gt;</span>
<span class="s"> &quot;&quot;&quot;</span> <span class="o">%</span> <span class="nb">vars</span><span class="p">()</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>The formula is displayed by loading <tt class="docutils literal"><span class="pre">tmp.html</span></tt> into a web browser.</p>
<p>Filename: <tt class="docutils literal"><span class="pre">fu_fem_int.py</span></tt>.</p>
</div>
<div class="section" id="problem-12-finite-elements-for-the-1d-bratu-problem">
<span id="nonlin-exer-1d-fu-discretize-fe"></span><h2>Problem 12: Finite elements for the 1D Bratu problem<a class="headerlink" href="#problem-12-finite-elements-for-the-1d-bratu-problem" title="Permalink to this headline">¶</a></h2>
<p>We address the same 1D Bratu problem as described in
<a class="reference internal" href="#nonlin-exer-1d-fu-discretize-fd"><em>Problem 10: Finite differences for the 1D Bratu problem</em></a>.</p>
<p><strong>a)</strong>
Discretize (<a class="reference internal" href="#nonlin-exer-1d-fu-discretize-fe"><em>Problem 12: Finite elements for the 1D Bratu problem</em></a>) by a finite element
method using a uniform mesh with P1 elements. Use a group
finite element method for the <span class="math">\(e^u\)</span> term.</p>
<p><strong>b)</strong>
Set up the nonlinear equations <span class="math">\(F_i(u_0,u_1,\ldots,u_{N_x})=0\)</span>
from a). Calculate the associated Jacobian.</p>
<p>Filename: <tt class="docutils literal"><span class="pre">nonlin_1D_Bratu_fe.pdf</span></tt>.</p>
</div>
<div class="section" id="problem-13-derive-the-newton-system-from-a-variational-form">
<span id="nonlin-exer-dd-heat-nonlinear-c-a"></span><h2>Problem 13: Derive the Newton system from a variational form<a class="headerlink" href="#problem-13-derive-the-newton-system-from-a-variational-form" title="Permalink to this headline">¶</a></h2>
<p>We study the multi-dimensional heat conduction PDE</p>
<div class="math">
\[\varrho c(T) T_t = \nabla\cdot (k(T)\nabla T)\]</div>
<p>in a spatial domain <span class="math">\(\Omega\)</span>, with a nonlinear Robin boundary condition</p>
<div class="math">
\[-k(T)\frac{\partial T}{\partial n} = h(T)(T-T_s(t)),\]</div>
<p>at the boundary <span class="math">\(\partial\Omega\)</span>.
The primary unknown is the temperature <span class="math">\(T\)</span>, <span class="math">\(\varrho\)</span> is the density
of the solid material, <span class="math">\(c(T)\)</span> is the heat capacity, <span class="math">\(k(T)\)</span> is
the heat conduction, <span class="math">\(h(T)\)</span> is a heat transfer coefficient, and
<span class="math">\(T_s(T)\)</span> is a possibly time-dependent temperature of the surroundings.</p>
<p><strong>a)</strong>
Use a Backward Euler or Crank-Nicolson time discretization and
derive the variational form for the spatial problem to be solved
at each time level.</p>
<p><strong>b)</strong>
Define a Picard iteration method from the variational form at
a time level.</p>
<p><strong>c)</strong>
Derive expressions for the matrix and the right-hand side of the
equation system that arises from applying Newton&#8217;s method to
the variational form at a time level.</p>
<p><strong>d)</strong>
Apply the Backward Euler or Crank-Nicolson scheme in time first.
Derive a Newton method at the PDE level. Make a variational
form of the resulting PDE at a time level.</p>
<p>Filename: <tt class="docutils literal"><span class="pre">nonlin_heat_Newton.pdf</span></tt>.</p>
</div>
<div class="section" id="problem-14-derive-algebraic-equations-for-nonlinear-1d-heat-conduction">
<span id="nonlin-exer-1d-heat-nonlinear-c-a"></span><h2>Problem 14: Derive algebraic equations for nonlinear 1D heat conduction<a class="headerlink" href="#problem-14-derive-algebraic-equations-for-nonlinear-1d-heat-conduction" title="Permalink to this headline">¶</a></h2>
<p>Consider a 1D heat conduction PDE</p>
<div class="math">
\[\varrho c(T) T_t = (k(T)T_x)_x,\]</div>
<p>where <span class="math">\(\varrho\)</span> is the density of the solid material, <span class="math">\(c(T)\)</span> is
the heat capacity, <span class="math">\(T\)</span> is the temperature, and <span class="math">\(k(T)\)</span> is the
heat conduction coefficient.</p>
<p>Use a uniform finite element mesh, P1 elements, and the group finite
element method to derive the algebraic equations arising from the
heat conduction PDE</p>
<p><strong>a)</strong>
Discretize the PDE by a finite difference method. Use either a
Backward Euler or Crank-Nicolson scheme in time.</p>
<p><strong>b)</strong>
Derive the matrix and right-hand side of a Newton method applied
to the discretized PDE.</p>
<p>Filename: <tt class="docutils literal"><span class="pre">nonlin_1D_heat_PDE.pdf</span></tt>.</p>
</div>
<div class="section" id="problem-15-investigate-a-1d-problem-with-a-continuation-method">
<span id="nonlin-exer-continuation-1dnnflow"></span><h2>Problem 15: Investigate a 1D problem with a continuation method<a class="headerlink" href="#problem-15-investigate-a-1d-problem-with-a-continuation-method" title="Permalink to this headline">¶</a></h2>
<p id="index-2">Flow of a pseudo-plastic power-law fluid between two flat plates can be
modeled by</p>
<div class="math">
\[\frac{d}{dx}\left(\mu_0\left\vert\frac{du}{dx}\right\vert^{n-1}
\frac{du}{dx}\right) = -\beta,\quad u^{\prime}(0)=0,\ u(H) = 0,\]</div>
<p>where <span class="math">\(\beta&gt;0\)</span> and <span class="math">\(\mu_0&gt;0\)</span> are constants.
A target value of <span class="math">\(n\)</span> may be <span class="math">\(n=0.2\)</span>.</p>
<p><strong>a)</strong>
Formulate a Picard iteration method directly for the differential
equation problem.</p>
<p><strong>b)</strong>
Perform a finite difference discretization of the problem in
each Picard iteration. Implement a solver that can compute <span class="math">\(u\)</span>
on a mesh. Verify that the solver gives an exact solution for <span class="math">\(n=1\)</span>
on a uniform mesh regardless of the cell size.</p>
<p><strong>c)</strong>
Given a sequence of decreasing <span class="math">\(n\)</span> values, solve the problem for each
<span class="math">\(n\)</span> using the solution for the previous <span class="math">\(n\)</span> as initial guess for
the Picard iteration. This is called a continuation method.
Experiment with <span class="math">\(n=(1,0.6,0.2)\)</span> and <span class="math">\(n=(1,0.9,0.8,\ldots,0.2)\)</span>
and make a table of the number of Picard iterations versus <span class="math">\(n\)</span>.</p>
<p><strong>d)</strong>
Derive a Newton method at the differential equation level and
discretize the resulting linear equations in each Newton iteration
with the finite difference method.</p>
<p><strong>e)</strong>
Investigate if Newton&#8217;s method has better convergence properties than
Picard iteration, both in combination with a continuation method.</p>
</div>
</div>
<div class="section" id="bibliography">
<h1>Bibliography<a class="headerlink" href="#bibliography" title="Permalink to this headline">¶</a></h1>
<table class="docutils citation" frame="void" id="ref1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Ref1]</td><td><strong>C. T. Kelley</strong>. <em>Iterative Methods for Linear and Nonlinear Equations</em>,
SIAM,
1995.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="ref2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Ref2]</td><td><strong>M. Mortensen, H. P. Langtangen and G. N. Wells</strong>. A FEniCS-Based Programming Framework for Modeling Turbulent Flow by the Reynolds-Averaged Navier-Stokes Equations,
<em>Advances in Water Resources</em>,
34(9),
<a class="reference external" href="http://dx.doi.org/10.1016/j.advwatres.2011.02.013">doi: 10.1016/j.advwatres.2011.02.013</a>,
2011.</td></tr>
</tbody>
</table>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <center>
            <p class="logo"><a href="http://cbc.simula.no/" title="Go to Center for Biomedical Computing">
              <img class="logo" src="_static/cbc_logo.png" alt="Logo"/>
            </a></p>
            </center>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Exercises</a><ul>
<li><a class="reference internal" href="#problem-1-determine-if-equations-are-nonlinear-or-not">Problem 1: Determine if equations are nonlinear or not</a></li>
<li><a class="reference internal" href="#exercise-2-derive-a-formula">Exercise 2: Derive a formula</a></li>
<li><a class="reference internal" href="#problem-3-experience-the-behavior-of-newton-s-method">Problem 3: Experience the behavior of Newton&#8217;s method</a></li>
<li><a class="reference internal" href="#problem-4-linearize-a-nonlinear-vibration-ode">Problem 4: Linearize a nonlinear vibration ODE</a></li>
<li><a class="reference internal" href="#exercise-5-find-the-sparsity-of-the-jacobian">Exercise 5: Find the sparsity of the Jacobian</a></li>
<li><a class="reference internal" href="#exercise-6-newton-s-method-for-linear-problems">Exercise 6: Newton&#8217;s method for linear problems</a></li>
<li><a class="reference internal" href="#exercise-7-differentiate-a-highly-nonlinear-term">Exercise 7: Differentiate a highly nonlinear term</a></li>
<li><a class="reference internal" href="#problem-8-discretize-a-1d-problem-with-a-nonlinear-coefficient">Problem 8: Discretize a 1D problem with a nonlinear coefficient</a></li>
<li><a class="reference internal" href="#problem-9-linearize-a-1d-problem-with-a-nonlinear-coefficient">Problem 9: Linearize a 1D problem with a nonlinear coefficient</a></li>
<li><a class="reference internal" href="#problem-10-finite-differences-for-the-1d-bratu-problem">Problem 10: Finite differences for the 1D Bratu problem</a></li>
<li><a class="reference internal" href="#problem-11-integrate-functions-of-finite-element-expansions">Problem 11: Integrate functions of finite element expansions</a></li>
<li><a class="reference internal" href="#problem-12-finite-elements-for-the-1d-bratu-problem">Problem 12: Finite elements for the 1D Bratu problem</a></li>
<li><a class="reference internal" href="#problem-13-derive-the-newton-system-from-a-variational-form">Problem 13: Derive the Newton system from a variational form</a></li>
<li><a class="reference internal" href="#problem-14-derive-algebraic-equations-for-nonlinear-1d-heat-conduction">Problem 14: Derive algebraic equations for nonlinear 1D heat conduction</a></li>
<li><a class="reference internal" href="#problem-15-investigate-a-1d-problem-with-a-continuation-method">Problem 15: Investigate a 1D problem with a continuation method</a></li>
</ul>
</li>
<li><a class="reference internal" href="#bibliography">Bibliography</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="._main_nonlin005.html"
                        title="previous chapter">Multi-dimensional PDE problems</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/._main_nonlin006.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="._main_nonlin005.html" title="Multi-dimensional PDE problems"
             >previous</a> |</li>
        <li><a href="index.html">Nonlinear differential equation problems</a> &raquo;</li> 
      </ul>
    </div>
<div class="wrapper">
  <div class="footer">
  <a href="http://cbc.simula.no"><img src="_static/cbc_banner.png" width="100%"><a>
  </div>
</div>

  </body>
</html>